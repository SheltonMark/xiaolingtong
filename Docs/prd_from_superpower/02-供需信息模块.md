# 供需信息模块

## 1. 模块概述

本模块涵盖企业用户之间的B2B供需信息对接，包括：
- 采购需求
- 工厂库存
- 代加工服务

**注意**：用工招聘属于临工用工模块，不在本模块范围内。

---

## 2. 信息类型定义

### 2.1 采购需求
| 字段 | 必填 | 说明 |
|-----|------|------|
| 标题 | ✅ | 简明描述采购内容 |
| 产品名称 | ✅ | |
| 品类 | ✅ | 下拉选择（后台配置） |
| 规格参数 | ✅ | 文本描述 |
| 采购数量 | ✅ | 数字 + 单位 |
| 质量要求 | ❌ | 文本描述 |
| 交货周期 | ✅ | 预计交货日期 |
| 预算范围 | ❌ | 支持填区间（如 10-15元/个） |
| 图片 | ❌ | 最多9张，单张≤5MB，支持JPG/PNG/JPEG |
| 联系人 | ✅ | 默认取认证时填写的联系人 |
| 联系电话 | ✅ | 默认取认证时填写的手机号 |
| 联系微信 | ❌ | |
| 有效期 | ✅ | 下拉选择（后台配置默认值） |

### 2.2 工厂库存
| 字段 | 必填 | 说明 |
|-----|------|------|
| 标题 | ✅ | 简明描述库存内容 |
| 产品名称 | ✅ | |
| 品类 | ✅ | 下拉选择 |
| 规格参数 | ✅ | 文本描述 |
| 库存数量 | ✅ | 数字 + 单位 |
| 单价 | ✅ | 支持填区间 |
| 库存状态 | ✅ | 现货 / 预售 |
| 最小起订量 | ❌ | |
| 货源地址 | ✅ | 省市区 |
| 交易说明 | ❌ | 如付款方式、物流方式 |
| 图片 | ✅ | 最多9张，至少1张 |
| 联系人 | ✅ | |
| 联系电话 | ✅ | |
| 联系微信 | ❌ | |
| 有效期 | ✅ | |

### 2.3 代加工服务
| 字段 | 必填 | 说明 |
|-----|------|------|
| 标题 | ✅ | 简明描述服务内容 |
| 加工品类 | ✅ | 下拉选择（如注塑加工、服装定制） |
| 加工能力 | ✅ | 日/月产能 |
| 支持工艺 | ✅ | 多选（后台配置） |
| 起订量 | ❌ | |
| 加工单价 | ❌ | 支持填区间 |
| 是否支持来图定制 | ✅ | 是/否 |
| 样品政策 | ❌ | 如"样品免费，邮费到付" |
| 交货周期 | ❌ | |
| 图片 | ❌ | 过往加工产品图、生产线图 |
| 联系人 | ✅ | |
| 联系电话 | ✅ | |
| 联系微信 | ❌ | |
| 有效期 | ✅ | |

---

## 3. 发布流程

### 3.1 发布流程图

```
┌─────────────┐
│  点击发布   │
└──────┬──────┘
       │
       ▼
┌─────────────┐     ┌─────────────┐
│ 检查认证状态 │ ──→ │  未认证     │ ──→ 提示去认证
└──────┬──────┘     └─────────────┘
       │ 已认证
       ▼
┌─────────────┐
│ 选择信息类型 │
│ 采购/库存/  │
│ 代加工      │
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  填写表单   │
└──────┬──────┘
       │
       ▼
┌─────────────┐
│  点击提交   │
└──────┬──────┘
       │
       ▼
┌─────────────────────────────────────┐
│          关键词黑名单检查            │
└──────────────────┬──────────────────┘
                   │
      ┌────────────┴────────────┐
      │                         │
      ▼                         ▼
┌─────────────┐          ┌─────────────┐
│ 触发敏感词   │          │  检查通过   │
│ 提示：       │          └──────┬──────┘
│ "包含敏感词  │                 │
│ 'xxx'，     │                 ▼
│ 请修改"     │          ┌─────────────────┐
│ 保留原文    │          │  审核模式判断    │
│ 停留编辑页  │          └────────┬────────┘
└─────────────┘                  │
                    ┌────────────┴────────────┐
                    │                         │
                    ▼                         ▼
             ┌─────────────┐          ┌─────────────┐
             │ 自动审核开启 │          │ 人工审核    │
             │ 直接上架     │          │ 状态：待审核│
             │ 状态：已发布 │          │ 等待管理员  │
             └─────────────┘          └─────────────┘
```

### 3.2 关键词检查规则
- 关键词黑名单由后台配置
- 检查范围：标题、所有文本描述字段
- 触发时：
  - 明确提示是哪个关键词
  - 保留用户已填写的所有内容
  - 停留在编辑页面，不跳转
  - 用户修改后可重新提交

---

## 4. 信息列表页

### 4.1 页面结构

```
┌─────────────────────────────────────────┐
│  🔍 搜索框                              │
│  [输入关键词搜索...]                     │
├─────────────────────────────────────────┤
│  筛选条件                               │
│  [品类 ▼] [地区 ▼] [排序 ▼]            │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐   │
│  │ 📦 产品标题                      │   │
│  │ 品类：xxx  |  数量：xxx          │   │
│  │ 价格：¥xx - ¥xx                 │   │
│  │ 地区：xxx  |  发布时间：x天前    │   │
│  │ [图片缩略图]                     │   │
│  └─────────────────────────────────┘   │
│  ┌─────────────────────────────────┐   │
│  │ ...更多信息卡片                  │   │
│  └─────────────────────────────────┘   │
└─────────────────────────────────────────┘
```

### 4.2 筛选条件
| 筛选项 | 说明 |
|-------|------|
| 品类 | 根据信息类型显示对应品类（后台配置） |
| 地区 | 只显示后台配置的已开放城市 |
| 排序 | 默认按发布时间倒序 |

### 4.3 搜索功能
- **企业用户搜索范围**：采购需求、工厂库存、代加工服务
- **临工用户搜索范围**：仅用工招聘（属于临工模块）
- 搜索字段：标题、产品名称、品类

---

## 5. 信息详情页

### 5.1 页面结构

```
┌─────────────────────────────────────────┐
│  [返回]              [举报]             │
├─────────────────────────────────────────┤
│  📷 图片轮播区                          │
│  [图1] [图2] [图3] ...                  │
├─────────────────────────────────────────┤
│  标题：xxxxxxxxxxxxxx                   │
│  品类：xxx                              │
│  发布时间：2026-01-15                   │
│  有效期至：2026-02-15                   │
├─────────────────────────────────────────┤
│  详细信息                               │
│  ─────────────────────                  │
│  产品名称：xxx                          │
│  规格参数：xxx                          │
│  数量：xxx                              │
│  价格：¥xx - ¥xx                       │
│  地区：xxx                              │
│  ...其他字段                            │
├─────────────────────────────────────────┤
│  联系方式                               │
│  ─────────────────────                  │
│  ┌─────────────────────────────────┐   │
│  │  🔒 查看联系方式                 │   │
│  │  消耗1次查看机会 / 会员免费查看   │   │
│  │  [立即查看]                      │   │
│  └─────────────────────────────────┘   │
│  或（已解锁后显示）：                    │
│  联系人：xxx                            │
│  电话：138xxxx1234                      │
│  微信：xxx                              │
└─────────────────────────────────────────┘
```

### 5.2 查看联系方式逻辑

```
点击"查看联系方式"
       │
       ▼
┌─────────────────┐
│  检查用户状态    │
└────────┬────────┘
         │
    ┌────┴────┐
    │         │
    ▼         ▼
 会员用户   非会员用户
    │         │
    │         ▼
    │    ┌─────────────┐
    │    │ 检查查看机会 │
    │    └──────┬──────┘
    │           │
    │      ┌────┴────┐
    │      │         │
    │      ▼         ▼
    │   有机会     无机会
    │      │         │
    │      │         ▼
    │      │    ┌─────────────┐
    │      │    │ 弹窗提示    │
    │      │    │ 购买/分享   │
    │      │    │ 获取机会    │
    │      │    └─────────────┘
    │      │
    │      ▼
    │   扣除1次机会
    │      │
    └──────┴──────┐
                  │
                  ▼
           显示联系方式
           记录查看日志
```

### 5.3 已查看记录
- 用户查看过的联系方式，再次查看**不再扣除机会**
- 系统记录用户的查看历史
- 可在"我的"页面查看历史记录

---

## 6. 我的发布

### 6.1 页面结构

```
┌─────────────────────────────────────────┐
│  我的发布                               │
├─────────────────────────────────────────┤
│  [全部] [采购需求] [库存] [代加工]       │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐   │
│  │ 📦 产品标题                      │   │
│  │ 状态：✅已发布 / ⏳待审核 /       │   │
│  │       ❌已驳回 / ⬇️已下架        │   │
│  │ 发布时间：2026-01-15            │   │
│  │ 有效期至：2026-02-15            │   │
│  │ [查看] [删除]                    │   │
│  └─────────────────────────────────┘   │
└─────────────────────────────────────────┘
```

### 6.2 信息状态
| 状态 | 说明 | 可操作 |
|-----|------|--------|
| 待审核 | 已提交，等待管理员审核 | 查看、删除 |
| 已发布 | 审核通过，前端展示中 | 查看、删除 |
| 已驳回 | 审核未通过 | 查看驳回原因、删除 |
| 已下架 | 有效期到期自动下架 | 查看、删除 |

### 6.3 已下架信息处理
- 已下架的信息**仅发布者可见**
- 只能**查看**或**删除**
- **不支持重新上架**，如需再发布需重新创建

---

## 7. 举报功能

### 7.1 举报入口
- 位置：信息详情页右上角

### 7.2 举报流程

```
点击"举报"
    │
    ▼
┌─────────────────────────────────────────┐
│  举报原因（单选）                        │
│  ○ 虚假信息                             │
│  ○ 联系方式无效                         │
│  ○ 涉嫌欺诈                             │
│  ○ 违规内容                             │
│  ○ 其他                                 │
├─────────────────────────────────────────┤
│  补充说明（选填）                        │
│  [文本输入框]                           │
├─────────────────────────────────────────┤
│  上传证据（选填）                        │
│  [+ 添加图片]                           │
├─────────────────────────────────────────┤
│  [提交举报]                             │
└─────────────────────────────────────────┘
```

### 7.3 举报处理
- 举报提交后，平台管理员在后台查看
- 核实后决定是否：
  - 下架信息
  - 扣除发布者信用分
  - 加入诚信曝光榜

---

## 8. 信息置顶/推广

### 8.1 功能说明
- 企业用户可付费让自己发布的信息在列表中置顶展示
- 置顶信息在列表顶部显示，带"置顶"标识

### 8.2 购买流程

```
信息详情页 / 我的发布
    │
    ▼
点击"推广置顶"
    │
    ▼
┌─────────────────────────────────────────┐
│  选择置顶时长                           │
│  ○ 1天 - ¥xx                           │
│  ○ 3天 - ¥xx                           │
│  ○ 7天 - ¥xx                           │
│  ○ 30天 - ¥xx                          │
│  （价格后台可配置）                      │
├─────────────────────────────────────────┤
│  [立即支付]                             │
└─────────────────────────────────────────┘
    │
    ▼
微信支付
    │
    ▼
置顶生效
```

### 8.3 置顶规则
- 多个置顶信息按购买时间排序（先买的在前）
- 置顶到期后自动恢复普通排序
- 置顶期间信息被下架，不退款

---

## 9. 接口清单

| 接口 | 方法 | 说明 |
|-----|------|------|
| /api/info/publish | POST | 发布信息 |
| /api/info/list | GET | 获取信息列表 |
| /api/info/detail/:id | GET | 获取信息详情 |
| /api/info/contact/:id | POST | 查看联系方式（扣除机会） |
| /api/info/my | GET | 我的发布列表 |
| /api/info/delete/:id | DELETE | 删除信息 |
| /api/info/report | POST | 举报信息 |
| /api/info/promote | POST | 购买置顶 |
| /api/info/categories | GET | 获取品类列表 |
| /api/info/cities | GET | 获取开放城市列表 |
