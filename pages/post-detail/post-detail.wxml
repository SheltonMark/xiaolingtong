<!--pages/post-detail/post-detail.wxml-->
<view class="detail-page">
  <!-- å›¾ç‰‡è½®æ’­ -->
  <swiper class="image-swiper" wx:if="{{detail.images.length > 0}}"
          indicator-dots autoplay circular
          bindchange="onSwiperChange">
    <swiper-item wx:for="{{detail.images}}" wx:key="*this">
      <image src="{{item}}" mode="aspectFill" class="swiper-img" />
    </swiper-item>
  </swiper>
  <view class="swiper-counter" wx:if="{{detail.images.length > 0}}">{{swiperCurrent + 1}}/{{detail.images.length}}</view>

  <!-- åŸºæœ¬ä¿¡æ¯ -->
  <view class="title-section">
    <view class="tag-row">
      <text class="tag tag-blue">{{detail.typeText}}</text>
      <text class="tag tag-amber">{{detail.industry}}</text>
    </view>
    <text class="detail-title">{{detail.title}}</text>
    <view class="title-meta">
      <text class="meta-text">å‘å¸ƒæ—¶é—´ï¼š{{detail.publishTime}}</text>
      <text class="meta-text">æœ‰æ•ˆæœŸè‡³ï¼š{{detail.expireTime}}</text>
    </view>
  </view>

  <!-- è¯¦ç»†ä¿¡æ¯ -->
  <view class="info-section">
    <view class="section-header-row">
      <text class="section-icon">ğŸ“‹</text>
      <text class="section-label">è¯¦ç»†ä¿¡æ¯</text>
    </view>
    <view class="info-list">
      <view class="info-row" wx:for="{{detail.fields}}" wx:key="label">
        <text class="info-label">{{item.label}}</text>
        <text class="info-value {{item.highlight ? 'text-cta font-semibold' : ''}} {{item.bold ? 'font-medium' : ''}}">{{item.value}}</text>
      </view>
    </view>
    <view class="desc-area" wx:if="{{detail.desc}}">
      <text class="desc-label">è¡¥å……æè¿°</text>
      <text class="desc-text">{{detail.desc}}</text>
    </view>
  </view>

  <!-- å‘å¸ƒè€…ä¿¡æ¯ -->
  <view class="publisher-section">
    <view class="section-header-row">
      <text class="section-icon">ğŸ¢</text>
      <text class="section-label">å‘å¸ƒè€…</text>
    </view>
    <view class="publisher-info">
      <image class="pub-avatar-img" src="{{detail.avatar || 'https://images.unsplash.com/photo-1560179707-f14e90ef3623?w=80&h=80&fit=crop'}}" mode="aspectFill" />
      <view class="pub-detail">
        <view class="pub-name-row">
          <text class="pub-name">{{detail.location}} Â· {{detail.certText}}</text>
          <text class="cert-badge">å·²è®¤è¯</text>
        </view>
        <text class="pub-industry">{{detail.industry}} Â· å‘å¸ƒä¿¡æ¯ {{detail.postCount || 12}} æ¡</text>
      </view>
    </view>
  </view>

  <!-- è”ç³»æ–¹å¼ -->
  <view class="contact-section">
    <view class="section-header-row">
      <text class="section-icon">ğŸ”’</text>
      <text class="section-label">è”ç³»æ–¹å¼</text>
    </view>
    <!-- æœªè§£é” -->
    <view class="contact-locked" wx:if="{{!contactUnlocked}}">
      <text class="lock-icon">ğŸ”’</text>
      <text class="lock-desc">æŸ¥çœ‹è”ç³»æ–¹å¼éœ€æ¶ˆè€—çµè±†</text>
      <text class="lock-hint">æ¶ˆè€— <text class="text-cta font-semibold">10çµè±†</text> Â· ä¼šå‘˜å…è´¹æŸ¥çœ‹</text>
      <button class="btn btn-primary" style="margin-top:24rpx;padding:16rpx 64rpx;" bindtap="onUnlockContact">ç«‹å³æŸ¥çœ‹</button>
    </view>
    <!-- å·²è§£é” -->
    <view class="contact-unlocked" wx:else>
      <view class="contact-row">
        <text class="contact-label">è”ç³»äºº</text>
        <text class="contact-value">{{contactInfo.name}}</text>
      </view>
      <view class="contact-row">
        <text class="contact-label">ç”µè¯</text>
        <text class="contact-value text-primary" bindtap="onCallPhone">{{contactInfo.phone}}</text>
      </view>
      <view class="contact-row" wx:if="{{contactInfo.wechat}}">
        <text class="contact-label">å¾®ä¿¡</text>
        <text class="contact-value">{{contactInfo.wechat}}</text>
        <text class="copy-btn" bindtap="onCopyWechat">å¤åˆ¶</text>
      </view>
    </view>
  </view>

  <!-- æµè§ˆé‡ -->
  <view class="view-count">
    <text class="view-count-text">{{detail.views || 1287}}äººæµè§ˆ Â· {{detail.contactViews || 32}}äººæŸ¥çœ‹è”ç³»æ–¹å¼</text>
  </view>

  <!-- åº•éƒ¨æ“ä½œ -->
  <view class="bottom-actions">
    <button class="bottom-btn btn-share" bindtap="onShare">
      <text class="bottom-btn-icon">â†—</text>
      <text>åˆ†äº«</text>
    </button>
    <button class="bottom-btn btn-chat flex-1" bindtap="onChat">
      <text class="bottom-btn-icon">ğŸ’¬</text>
      <text>åœ¨çº¿èŠ</text>
    </button>
    <button class="bottom-btn btn-contact flex-1" bindtap="onUnlockContact" wx:if="{{!contactUnlocked}}">
      <text class="bottom-btn-icon">ğŸ”’</text>
      <text>æŸ¥çœ‹è”ç³»æ–¹å¼</text>
    </button>
    <button class="bottom-btn btn-contact flex-1" bindtap="onCallPhone" wx:else>
      <text class="bottom-btn-icon">ğŸ“</text>
      <text>ç«‹å³è”ç³»</text>
    </button>
  </view>
</view>
