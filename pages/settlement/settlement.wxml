<!--pages/settlement/settlement.wxml-->
<view class="st-page">
  <!-- å·¥ä½œæ¦‚è¦ -->
  <view class="st-card">
    <view class="st-job-header">
      <view class="st-avatar">ğŸ­</view>
      <view class="st-job-info">
        <text class="st-company">{{job.company}} Â· {{job.jobType}}</text>
        <text class="st-date">{{job.dateRange}}</text>
      </view>
    </view>
    <view class="st-summary">
      <view class="st-sum-item">
        <text class="st-sum-val">{{job.totalWorkers}}</text>
        <text class="st-sum-label">å®åˆ°äººæ•°</text>
      </view>
      <view class="st-sum-item">
        <text class="st-sum-val">{{job.totalHours}}h</text>
        <text class="st-sum-label">æ€»å·¥æ—¶</text>
      </view>
      <view class="st-sum-item">
        <text class="st-sum-val text-primary">Â¥{{job.factoryTotal}}</text>
        <text class="st-sum-label">å·¥å‚æ€»æ”¯ä»˜</text>
      </view>
    </view>
  </view>

  <!-- ç¡®è®¤çŠ¶æ€ -->
  <view class="st-card">
    <text class="card-title">ç¡®è®¤çŠ¶æ€</text>
    <view class="step-list">
      <view class="step-item" wx:for="{{steps}}" wx:key="label">
        <view class="step-dot {{item.done ? 'dot-done' : 'dot-pending'}}">
          <text wx:if="{{item.done}}">âœ“</text>
          <text wx:else>â±</text>
        </view>
        <view class="step-content">
          <text class="step-label">{{item.label}}</text>
          <text class="step-time">{{item.time}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç»“ç®—æ˜ç»† -->
  <view class="st-card">
    <text class="card-title">ç»“ç®—æ˜ç»†</text>
    <!-- è¡¨å¤´ -->
    <view class="table-header">
      <text class="th" style="flex:1.2;">å§“å</text>
      <text class="th" style="flex:1;">å·¥æ—¶</text>
      <text class="th" style="flex:1.2;">å·¥å‚ä»˜</text>
      <text class="th" style="flex:1.2;">ä¸´å·¥å¾—</text>
      <text class="th" style="flex:1;">çŠ¶æ€</text>
    </view>
    <!-- è¡¨è¡Œ -->
    <view class="table-row" wx:for="{{workers}}" wx:key="name">
      <text class="td" style="flex:1.2;">{{item.name}}</text>
      <text class="td" style="flex:1;">{{item.hours}}h</text>
      <text class="td" style="flex:1.2;">Â¥{{item.factoryPay}}</text>
      <text class="td" style="flex:1.2;">Â¥{{item.workerPay}}</text>
      <text class="td {{item.confirmed ? 'text-fresh' : 'text-warm'}}" style="flex:1;">{{item.confirmed ? 'å·²ç¡®è®¤' : 'å¾…ç¡®è®¤'}}</text>
    </view>
    <text class="view-all" bindtap="onViewAll">æŸ¥çœ‹å…¨éƒ¨{{job.totalWorkers}}äººæ˜ç»†</text>
  </view>

  <!-- è´¹ç”¨æ±‡æ€» -->
  <view class="st-card">
    <text class="card-title">è´¹ç”¨æ±‡æ€»</text>
    <view class="fee-list">
      <view class="fee-row">
        <text class="fee-label">å·¥å‚æ€»æ”¯ä»˜</text>
        <text class="fee-value">Â¥{{fees.factoryTotal}}</text>
      </view>
      <view class="fee-row">
        <text class="fee-label">å¹³å°æœåŠ¡è´¹ï¼ˆ20%ï¼‰</text>
        <text class="fee-value fee-minus">-Â¥{{fees.platformFee}}</text>
      </view>
      <view class="fee-row">
        <text class="fee-label">ç®¡ç†å‘˜æœåŠ¡è´¹</text>
        <text class="fee-value fee-minus">-Â¥{{fees.managerFee}}</text>
      </view>
      <view class="fee-divider"></view>
      <view class="fee-row fee-total">
        <text class="fee-label">ä¸´å·¥å®å‘æ€»é¢</text>
        <text class="fee-value text-cta">Â¥{{fees.workerTotal}}</text>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ”¯ä»˜ -->
  <view class="st-bottom">
    <button class="btn btn-primary" bindtap="onPay">ç¡®è®¤æ”¯ä»˜ Â¥{{job.factoryTotal}}</button>
    <text class="st-hint">æ”¯ä»˜åå·¥èµ„å°†è‡ªåŠ¨å‘æ”¾è‡³ä¸´å·¥é’±åŒ…</text>
  </view>
</view>
