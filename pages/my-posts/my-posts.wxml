<!--pages/my-posts/my-posts.wxml-->
<view class="my-posts-page">
  <!-- Tab -->
  <view class="tab-bar">
    <view class="tab-item {{currentTab === index ? 'tab-active' : ''}}"
          wx:for="{{tabs}}" wx:key="index"
          data-index="{{index}}" bindtap="onTabChange">
      <text>{{item}}</text>
    </view>
  </view>

  <!-- 列表 -->
  <view class="post-list">
    <view class="post-card {{item.status === 'offline' ? 'card-offline' : ''}}"
          wx:for="{{posts}}" wx:key="id"
          wx:if="{{currentTab === 0 || item.type === tabs[currentTab]}}">
      <view class="post-top">
        <text class="type-tag type-{{item.typeColor}}">{{item.type}}</text>
        <view class="status-tag status-bg-{{item.statusColor}}">
          <text>{{item.statusText}}</text>
        </view>
      </view>
      <text class="post-title">{{item.title}}</text>
      <!-- 驳回原因 -->
      <view class="reject-box" wx:if="{{item.rejectReason}}">
        <text class="reject-text">驳回原因：{{item.rejectReason}}</text>
      </view>
      <view class="post-meta">
        <text class="meta-item">发布：{{item.publishTime}}</text>
        <text class="meta-item" wx:if="{{item.expireTime && !item.expired}}">有效期至：{{item.expireTime}}</text>
        <text class="meta-item" wx:if="{{item.expired}}">已过期：{{item.expireTime}}</text>
        <text class="meta-item meta-views" wx:if="{{item.views > 0}}">{{item.views}}次浏览</text>
      </view>
      <!-- 操作按钮 -->
      <view class="post-actions">
        <button class="act-btn act-blue" data-id="{{item.id}}" bindtap="onViewPost">查看详情</button>
        <button class="act-btn act-orange" wx:if="{{item.canSettle}}" data-id="{{item.jobId}}" bindtap="onGoSettlement">去结算</button>
        <button class="act-btn act-orange" wx:elif="{{item.canPromote}}" data-id="{{item.id}}" bindtap="onPromotePost">推广置顶</button>
        <button class="act-btn act-rose" data-id="{{item.id}}" bindtap="onDeletePost">删除</button>
      </view>
    </view>
  </view>

  <empty-state wx:if="{{posts.length === 0}}" text="暂无发布记录" subText="去发布第一条信息吧" />
</view>
