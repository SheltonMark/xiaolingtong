<!--pages/my-applications/my-applications.wxml-->
<view class="ma-page">
  <!-- Tab -->
  <view class="tab-bar">
    <view class="tab-item {{currentTab === index ? 'tab-active' : ''}}"
          wx:for="{{tabs}}" wx:key="index"
          data-index="{{index}}" bindtap="onTabChange">
      <text>{{item}}</text>
    </view>
  </view>

  <!-- åˆ—è¡¨ -->
  <view class="app-list">
    <!-- å¾…ç¡®è®¤å‡ºå‹¤ -->
    <view class="app-card {{item.status === 'rejected' ? 'card-faded' : ''}}"
          wx:for="{{list}}" wx:key="id"
          wx:if="{{currentTab === 0 || item.tabKey === tabs[currentTab]}}">
      <!-- å¤´éƒ¨ -->
      <view class="app-header">
        <view class="app-header-left">
          <image class="app-avatar-img" src="{{item.avatar}}" mode="aspectFill" />
          <text class="app-company">{{item.company}}</text>
        </view>
        <view class="status-tag status-bg-{{item.statusBg}}">
          <view class="pulse-dot" wx:if="{{item.status === 'ongoing'}}"></view>
          <text>{{item.statusText}}</text>
        </view>
      </view>
      <!-- å²—ä½+è–ªèµ„ -->
      <text class="app-job-line">{{item.title}} Â· <text class="text-cta">{{item.salary}}</text></text>
      <!-- æ—¥æœŸ -->
      <view class="app-date-row">
        <text class="date-icon">ğŸ“…</text>
        <text class="app-date">{{item.date}}</text>
        <text class="app-date" wx:if="{{item.hours}}"> Â· {{item.hours}}</text>
      </view>
      <!-- æé†’ -->
      <view class="app-alert" wx:if="{{item.alert}}">
        <text class="alert-icon">â±</text>
        <text class="alert-text">{{item.alert}}</text>
      </view>
      <!-- ç»Ÿè®¡ -->
      <view class="app-stats" wx:if="{{item.stats}}">
        <view class="stat-item" wx:for="{{item.stats}}" wx:for-item="s" wx:key="label">
          <text class="stat-value" style="color:{{s.color || '#1E293B'}};">{{s.value}}</text>
          <text class="stat-label">{{s.label}}</text>
        </view>
      </view>
      <!-- æ“ä½œ -->
      <button class="confirm-btn" wx:if="{{item.status === 'confirm'}}"
              data-id="{{item.id}}" bindtap="onConfirmAttend">ç¡®è®¤å‡ºå‹¤</button>
      <view class="app-actions" wx:if="{{item.status === 'done'}}">
        <button class="act-btn act-blue" data-id="{{item.id}}" bindtap="onViewDetail">æŸ¥çœ‹è¯¦æƒ…</button>
        <button class="act-btn act-orange" data-id="{{item.id}}" bindtap="onRate">è¯„ä»·ä¼ä¸š</button>
      </view>
    </view>
  </view>

  <empty-state wx:if="{{list.length === 0}}" text="æš‚æ— æŠ¥åè®°å½•" />
</view>
